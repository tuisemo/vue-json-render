---
name: lib-build-verify
description: 执行前端库的依赖安装与构建流程，并在构建失败时自动分析错误日志进行修复，直至构建成功。
---

# Library Build & Verify Protocol

当你在修改了库的源代码 (`src/`) 或依赖配置 (`package.json`) 后，**必须**执行此流程以确保库的完整性。

## 流程步骤

1.  **同步依赖**
    *   执行命令: `pnpm install`
    *   *目的*: 确保所有新增的依赖都已正确安装。

2.  **执行构建**
    *   执行命令: `pnpm build`
    *   *注意*: 仔细观察终端输出的 `stdout` 和 `stderr`。

3.  **结果分析与决策 (关键步骤)**

    *   **情况 A: 构建成功 (Exit Code 0)**
        *   输出: "构建成功，代码验证通过。"
        *   结束技能。

    *   **情况 B: 构建失败 (Exit Code != 0)**
        *   **捕获**: 读取终端中的报错信息（如 TypeScript 类型错误、Rollup/Vite 打包错误等）。
        *   **思考**: 分析报错原因（是语法错误？缺少导出？类型不匹配？）。
        *   **行动**:
            1.  直接修改相关代码文件进行修复。
            2.  **递归调用**: 修复完成后，**必须重新跳转到步骤 2** 再次执行 `pnpm build` 进行验证。
            3.  如果连续 3 次修复失败，停止并向用户请求人工介入（防止死循环）。

## 示例
> 终端: "TS2322: Type 'string' is not assignable to type 'number'."
> 动作: 找到对应的变量定义，将其类型修改正确，然后再次运行 pnpm build。
